name: mingpt-gpu-instance

resources:
  cloud: aws
  cpus: 4+
  disk_size: 128
  accelerators: T4:4

workdir: .

setup: |
  set -e  # Exit if any command failed.
  conda env create -f conda.yml

run: |
  set -e  # Exit if any command failed.
  conda activate tf-mingpt
  python mingpt.py generate "First" --no-pretrained # This will generate garbage
  python mingpt.py train
  python mingpt.py generate "First" # This is generate slightly better garbage
